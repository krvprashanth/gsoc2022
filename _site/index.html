<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2709176-10"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2709176-10', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Home | GSoC’22 Contributor Wiki</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Home" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Jekyll theme for documentation" /><meta property="og:description" content="A Jekyll theme for documentation" /><link rel="canonical" href="http://localhost:4000/" /><meta property="og:url" content="http://localhost:4000/" /><meta property="og:site_name" content="GSoC’22 Contributor Wiki" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Home" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebSite","description":"A Jekyll theme for documentation","headline":"Home","name":"GSoC’22 Contributor Wiki","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/header-logo.png"}},"url":"http://localhost:4000/"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"><div class="site-logo"></div></a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item active"><a href="http://localhost:4000/" class="nav-list-link active">Home</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/blog/" class="nav-list-link">Blog</a><ul class="nav-list "></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/documentation/" class="nav-list-link">Documentation</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/documentation/how-to-guides/" class="nav-list-link">How-To Guides</a><li class="nav-list-item "><a href="http://localhost:4000/docs/documentation/project-notes/" class="nav-list-link">Project Notes</a><li class="nav-list-item "><a href="http://localhost:4000/docs/documentation/building-bela-images/" class="nav-list-link">Building Bela Images</a><li class="nav-list-item "><a href="http://localhost:4000/docs/documentation/the-summary/" class="nav-list-link">The Summary</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/weeklyprogress/" class="nav-list-link">Weekly Progress</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/Pre%20Selection/" class="nav-list-link">Pre Selection</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/Community%20Bonding%20Period/" class="nav-list-link">Community Bonding Period</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week1/" class="nav-list-link">Week 1</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week2/" class="nav-list-link">Week 2</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week3-4/" class="nav-list-link">Week 3 & 4</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week5/" class="nav-list-link">Week 5</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week6/" class="nav-list-link">Week 6</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week7/" class="nav-list-link">Week 7</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week8/" class="nav-list-link">Week 8</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week9/" class="nav-list-link">Week 9</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week10/" class="nav-list-link">Week 10</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week11/" class="nav-list-link">Week 11</a><li class="nav-list-item "><a href="http://localhost:4000/docs/weeklyprogress/week12/" class="nav-list-link">Week 12</a></ul><li class="nav-list-item"><a href="http://localhost:4000/docs/contact/" class="nav-list-link">Contact</a></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search GSoC'22 Contributor Wiki" aria-label="Search GSoC'22 Contributor Wiki" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div></div><div id="main-content-wrap" class="main-content-wrap"><div id="main-content" class="main-content" role="main"><h1 id="building-bela-images"> <a href="#building-bela-images" class="anchor-heading" aria-labelledby="building-bela-images"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Building Bela Images</strong></h1><h2 id="gsoc2022--beagleboardorg"> <a href="#gsoc2022--beagleboardorg" class="anchor-heading" aria-labelledby="gsoc2022--beagleboardorg"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong><a href="https://summerofcode.withgoogle.com/programs/2022/organizations/beagleboardorg">GSoC’2022 | BeagleBoard.org</a></strong></h2><hr /><p><img src="assets/images/photo6100226193669337986.jpg" alt="intro" /></p><p>The project idea was to Improve the maintainability of the Bela Image development by adding the functionalities of the Bela Image builder repo to the BeagleBoard Image builder repo.</p><h2 id="about"> <a href="#about" class="anchor-heading" aria-labelledby="about"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>About</strong></h2><ul><li><em>Student Name:</em> <a href="https://krvprashanth.in">Kurva Prashanth</a><li><em>Mentors:</em> Giulio Moro, Vedant Paranjape, Vaishnav Achath<li><em>GSoC Entry link:</em> <a href="https://summerofcode.withgoogle.com/programs/2022/projects/ykkMkxcR">Program Project Page</a><li><em>Wiki:</em> <a href="https://bela.io/gsoc">Building Bela Images</a><li><em>Blog Link:</em> <a href="https://krvprashanth.in/gsoc2022/">Building Bela Images</a> <br /></ul><h2 id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Table of Contents</strong></h2><ol><li><a href="#intro">Introduction</a><ul><li><a href="#rebuild">Why Bela Image has been built again?</a><li><a href="#preview">Project Preview</a><li><a href="#overview">Brief Overview of Bela Image</a></ul><li><a href="#docs">Documentation</a><ul><li><a href="#debian-packages">Debian – Packages</a><li><a href="#omap">omap-image-builder</a><li><a href="#belasoftware">Bela Software</a><li><a href="#writings">Writings</a></ul><li><a href="#contribution">Contributions</a><ul><li><a href="#milestones">Achieved Milestones</a><li><a href="#repos">Git Repositories</a><li><a href="#pr">Pull Requests</a></ul><li><a href="#scope">Further Implementation</a><li><a href="#conclusion">Conclusion</a><li><a href="#ref">Helpful Links</a></ol><hr /><h2 id="introduction-"> <a href="#introduction-" class="anchor-heading" aria-labelledby="introduction-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Introduction</strong> <a name="intro"></a></h2><p>Bela is an open hardware and software platform for creating beautiful interaction with sensors, sound and it is designed for artists, musicians, researchers and makers, Bela brings the power of ultra-low latency interactive audio and sensors to digital systems.</p><p>Bela Platform uses the Bela software which is a customised Debian distribution including a custom xenomai kernel, minimal clutter, and custom systemd configurations and It takes advantage of features of the BeagleBone computers and can achieve extremely fast audio and sensor processing times.</p><h3 id="why-bela-image-has-been-built-again-"> <a href="#why-bela-image-has-been-built-again-" class="anchor-heading" aria-labelledby="why-bela-image-has-been-built-again-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Why Bela Image has been built again?</strong> <a name="rebuild"></a></h3><p>The Bela Image development repo is heavily based and which was initially inspired by Beagleboard Image-builder scripts. Currently, the Beagle board Image development repo diverged greatly from a common functionalities of building Images.</p><p>And, there is an requirement to “rebase” the functionalities of the Bela Image builder repo to the Beagleboard Image builder one. As the two codebases are drastically different and need to rebuild the Bela Image and add the features of the Bela Image builder repo (xenomai kernel building scripts along with a bunch of Bela core) to Beagleboard Image builder repo.</p><p>Now, after the specific changes the Bela Image development is following more closely with the Beagleboard Image development and as a result from now the Bela Image will be updated more often and it minimized further development effort.</p><h3 id="project-preview-"> <a href="#project-preview-" class="anchor-heading" aria-labelledby="project-preview-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Project Preview</strong> <a name="preview"></a></h3><p>The main goal is to Improve the maintainability of the Bela Image development by adding the functionalities of the Bela Image builder repo to the BeagleBoard Image builder repo.</p><p><strong>Note</strong>: <em>This project isn’t rewrite omap-image-builder with bela changes, it’s merge bela changes into omap-image-builder</em>.</p><p>Bela Image builds with <a href="https://github.com/RobertCNelson/omap-image-builder">RobertCNelson/omap-image-builder scripts</a>, These are the same build scripts that were used to generate the official BeagleBoard Images, found here: <a href="https://beagleboard.org/latest-images">https://beagleboard.org/latest-images</a></p><h5 id="bela---build-script-instructions"> <a href="#bela---build-script-instructions" class="anchor-heading" aria-labelledby="bela---build-script-instructions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Bela - Build-Script Instructions</strong></h5><p>These scripts are tested on Debian x86 machine.</p><p>A typical workflow to build a Bela Image would look like:</p><ul><li><p>Download RobertCNelson/omap-image-builder</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> git clone https://github.com/RobertCNelson/omap-image-builder
 cd ./omap-image-builder
</code></pre></div></div><li><p><strong>Generate</strong>: Debian root file system</p></ul><p>Debian Bullseye 11.5</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   ./RootStock-NG.sh -c bela.io-debian-bullseye-v4.14-ti-xenomai-armhf
</code></pre></div></div><p>Archive will be under <code class="language-plaintext highlighter-rouge">./deploy/</code></p><ul><li><p><strong>Finalize</strong>: Bela specific version:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sudo ./setup_sdcard.sh --img-4gb bela-image --dtb beaglebone --distro-bootloader --enable-cape-universal --enable-load-bela-overlay
</code></pre></div></div></ul><p>After the script finishes running, we will have an image file generated.</p><h3 id="brief-overview-of-bela-image-"> <a href="#brief-overview-of-bela-image-" class="anchor-heading" aria-labelledby="brief-overview-of-bela-image-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Brief Overview of Bela Image</strong> <a name="overview"></a></h3><ul><li>Image uses Debian 11 (Bullseye) with the <a href="https://github.com/RobertCNelson/ti-linux-kernel-dev/tree/ti-linux-xenomai-bela-4.14.y">ti-linux-xenomai-bela-4.14.y</a> and <code class="language-plaintext highlighter-rouge">Xenomai v3.0.13</code><li>Image have the default root user with no password.<li>On the first boot, the image will expand to fill the eMMC or SD card.<li>Root login over ssh is enabled.<li>The hostname is set to the name of board it’s for as Bela<li>Loads Bela IDE over browser, <code class="language-plaintext highlighter-rouge">bela.local</code><li>Uses Robert Nelson’s Beaglebone image-builder scripts to build image.</ul><hr /><h2 id="documentation-"> <a href="#documentation-" class="anchor-heading" aria-labelledby="documentation-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Documentation</strong> <a name="docs"></a></h2><h3 id="debian--packages"> <a href="#debian--packages" class="anchor-heading" aria-labelledby="debian--packages"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Debian – Packages</strong></h3><h5 id="introductory-notes"> <a href="#introductory-notes" class="anchor-heading" aria-labelledby="introductory-notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Introductory notes</strong></h5><p>Debian package updated/packaged the dependencies of Bela and pushed to apt packager manager at <a href="https://rcn-ee.com">https://rcn-ee.com</a> that used in omap-image-builder along with mainline Debian apt package manager.</p><p>Debian 11: (bullseye): <a href="http://repos.rcn-ee.com/debian/">http://repos.rcn-ee.com/debian/</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb [arch=armhf] http://repos.rcn-ee.com/debian/ bullseye main
#deb-src [arch=armhf] http://repos.rcn-ee.com/debian/ bullseye main
</code></pre></div></div><h5 id="package-lists"> <a href="#package-lists" class="anchor-heading" aria-labelledby="package-lists"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Package lists</strong></h5><p>These are the Bela required packages that are up in <a href="https://rcn-ee.com">https://rcn-ee.com</a></p><div class="table-wrapper"><table><tbody><tr><td>bela-customizations<td>Bela customizations<tr><td>bela-seasocks<td>Simple, small, C++ embeddable webserver with WebSockets support<tr><td>hvcc<td>hvcc compiler for Pure Data patches - python3<tr><td>libxenomai1-v3.0<td>Shared libraries for Xenomai<tr><td>libxenomai-v3.0-dev<td>Headers and static libraries for Xenomai<tr><td>linux-image-4.14.108-ti-xenomai-bela-r2<td>linux-image*deb<tr><td>linux-headers-4.14.108-ti-xenomai-bela-r2<td>linux-headers*deb<tr><td>xenomai-v3.0-kernel-source<td>Sources of the Xenomai 2.x kernel<tr><td>xenomai-v3.0-runtime<td>Xenomai runtime utilities</table></div><h3 id="omap-image-builder"> <a href="#omap-image-builder" class="anchor-heading" aria-labelledby="omap-image-builder"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>omap-image-builder</strong></h3><h5 id="bootloader-u-boot"> <a href="#bootloader-u-boot" class="anchor-heading" aria-labelledby="bootloader-u-boot"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Bootloader: U-Boot</strong></h5><p>Cape device tree overlays (src): <a href="https://github.com/beagleboard/bb.org-overlays/">https://github.com/beagleboard/bb.org-overlays/</a></p><p>Debian package: bb-cape-overlays</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>uboot_overlay_addr0=/lib/firmware/&lt;file0&gt;.dtbo
uboot_overlay_addr1=/lib/firmware/&lt;file1&gt;.dtbo
uboot_overlay_addr2=/lib/firmware/&lt;file2&gt;.dtbo
uboot_overlay_addr3=/lib/firmware/&lt;file3&gt;.dtbo
</code></pre></div></div><p>If for some reason we need to disable the auto-loading of any of ^ those, use the option that matches addrX:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>disable_uboot_overlay_addr0=1
disable_uboot_overlay_addr1=1
disable_uboot_overlay_addr2=1
disable_uboot_overlay_addr3=1
</code></pre></div></div><p>4 more capes can be loaded via:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>uboot_overlay_addr4=/lib/firmware/&lt;file4&gt;.dtbo
uboot_overlay_addr5=/lib/firmware/&lt;file5&gt;.dtbo
uboot_overlay_addr6=/lib/firmware/&lt;file6&gt;.dtbo
uboot_overlay_addr7=/lib/firmware/&lt;file7&gt;.dtbo
</code></pre></div></div><p>Plus one custom cape:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dtb_overlay=/lib/firmware/&lt;file8&gt;.dtbo  
</code></pre></div></div><h5 id="u-boot-bootuenvtxt-configuration"> <a href="#u-boot-bootuenvtxt-configuration" class="anchor-heading" aria-labelledby="u-boot-bootuenvtxt-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>U-Boot /boot/uEnv.txt configuration</strong></h5><p>/boot/uEnv.txt:</p><p>In Bela Image build used this configuration to <a href="https://github.com/RobertCNelson/omap-image-builder/blob/f5257ee96abdb30d5716cd85147877cfd06f76e8/tools/setup_sdcard.sh#L1296">load Bela Overlay</a>, <a href="https://github.com/RobertCNelson/omap-image-builder/blob/f5257ee96abdb30d5716cd85147877cfd06f76e8/tools/setup_sdcard.sh#L524">Use Distro Bootloader</a>, and <a href="https://github.com/RobertCNelson/omap-image-builder/blob/f5257ee96abdb30d5716cd85147877cfd06f76e8/tools/setup_sdcard.sh#L1271">Cape Universal Enable</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--distro-bootloader --enable-cape-universal --enable-load-bela-overlay 
</code></pre></div></div><h5 id="enable-and-load-custom-device-tree-overlay"> <a href="#enable-and-load-custom-device-tree-overlay" class="anchor-heading" aria-labelledby="enable-and-load-custom-device-tree-overlay"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Enable and Load Custom Device Tree Overlay</strong></h5><p>In <a href="https://github.com/RobertCNelson/omap-image-builder/blob/master/tools/setup_sdcard.sh">omap-image-builder/tools/setup_sdcard.sh</a></p><p>Just tweak it here: <a href="https://github.com/RobertCNelson/omap-image-builder/blob/f9b6785eca8c275dc665012efef06141400c5846/tools/setup_sdcard.sh#L1289">https://github.com/RobertCNelson/omap-image-builder/blob/f9b6785eca8c275dc665012efef06141400c5846/tools/setup_sdcard.sh#L1289</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   ###Todo: make this more generic so you can specify any overlay...
       if [ "x${load_custom_overlay}" = "xenable" ] ; then
              echo "###" &gt;&gt; ${wfile}
              echo "dtb_overlay=PB-HACKADAY-2021.dtbo" &gt;&gt; ${wfile}
               echo "" &gt;&gt; ${wfile}
       fi
</code></pre></div></div><p>Load With: <a href="https://github.com/RobertCNelson/omap-image-builder/blob/f9b6785eca8c275dc665012efef06141400c5846/tools/setup_sdcard.sh#L2102">https://github.com/RobertCNelson/omap-image-builder/blob/f9b6785eca8c275dc665012efef06141400c5846/tools/setup_sdcard.sh#L2102</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--enable-load-custom-overlay)
	load_custom_overlay="enable"
	;;
</code></pre></div></div><h5 id="populating-rootfs-and-boot-partition"> <a href="#populating-rootfs-and-boot-partition" class="anchor-heading" aria-labelledby="populating-rootfs-and-boot-partition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Populating rootfs and Boot Partition</strong></h5><h6 id="boot-partition"> <a href="#boot-partition" class="anchor-heading" aria-labelledby="boot-partition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://github.com/RobertCNelson/omap-image-builder/blob/f5257ee96abdb30d5716cd85147877cfd06f76e8/tools/setup_sdcard.sh#L808"><strong>Boot Partition</strong></a></h6><h6 id="rootfs-partition"> <a href="#rootfs-partition" class="anchor-heading" aria-labelledby="rootfs-partition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://github.com/RobertCNelson/omap-image-builder/blob/f5257ee96abdb30d5716cd85147877cfd06f76e8/tools/setup_sdcard.sh#L923"><strong>Rootfs Partition</strong></a></h6><h3 id="bela-software"> <a href="#bela-software" class="anchor-heading" aria-labelledby="bela-software"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Bela Software</strong></h3><h5 id="bela-core"> <a href="#bela-core" class="anchor-heading" aria-labelledby="bela-core"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Bela Core</strong></h5><p><code class="language-plaintext highlighter-rouge">seasocks</code>, <code class="language-plaintext highlighter-rouge">am335x_pru_package</code>, <code class="language-plaintext highlighter-rouge">Bela IDE</code>, <code class="language-plaintext highlighter-rouge">prudebug</code>, <code class="language-plaintext highlighter-rouge">rtdm_pruss_irq</code>, <code class="language-plaintext highlighter-rouge">hvcc</code> are installed through <a href="https://github.com/RobertCNelson/omap-image-builder/blob/master/target/chroot/bela.io-bullseye.sh">/target/chroot/bela.io-bullseye.sh</a> script and <code class="language-plaintext highlighter-rouge">custom xenomai kernel</code> and all other <code class="language-plaintext highlighter-rouge">Bela required packages</code> are installed through <a href="/configs/bela.io-debian-bullseye-v4.14-ti-xenomai-armhf.conf">/configs/bela.io-debian-bullseye-v4.14-ti-xenomai-armhf.conf</a></p><h5 id="bela-customizations"> <a href="#bela-customizations" class="anchor-heading" aria-labelledby="bela-customizations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Bela Customizations</strong></h5><p>The <code class="language-plaintext highlighter-rouge">bela-customizations</code> debian package ships these (<a href="https://github.com/BelaPlatform/bela-image-builder/tree/master/misc/rootfs">https://github.com/BelaPlatform/bela-image-builder/tree/master/misc/rootfs</a>) files as it is to bela image.</p><p>Initialized a repo for bela-customizations and copied the /misc/rootfs of bela-image-builder repo in it and used this repo as source for packaging.</p><h6 id="removed"> <a href="#removed" class="anchor-heading" aria-labelledby="removed"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Removed</strong></h6><ul><li><code class="language-plaintext highlighter-rouge">dhcp.conf</code> cause bela-customizations package failed to install due to ‘/etc/dhcp/dhcpd.conf’, which is also in package isc-dhcp-server and better file, this has dhcp enabled…, that exact same setup is done thru systemd-network.. with: bb-usb-gadget package… <a href="https://github.com/rcn-ee/repos/blob/master/bb-usb-gadgets/suite/bullseye/debian/usb0-DHCP.network">https://github.com/rcn-ee/repos/blob/master/bb-usb-gadgets/suite/bullseye/debian/usb0-DHCP.network</a><li><code class="language-plaintext highlighter-rouge">securetty</code> In Debian Bullseye, the runtime that use to use etc/securetty no longer uses that file.. it was completely removed as a legacy option.. Reference: <a href="https://www.debian.org/lts/security/2021/dla-2596">https://www.debian.org/lts/security/2021/dla-2596</a><li><code class="language-plaintext highlighter-rouge">fstab</code>, <code class="language-plaintext highlighter-rouge">hosts</code> these files are generated when we run setup_sdcard.sh of omap-image-builder<li><code class="language-plaintext highlighter-rouge">interfaces</code> systemd-network uses a new inteface..<li><code class="language-plaintext highlighter-rouge">wpa_supplicant.conf</code> will find it already pre-installed..</ul><h4 id="changes-that-need-to-be-done"> <a href="#changes-that-need-to-be-done" class="anchor-heading" aria-labelledby="changes-that-need-to-be-done"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Changes that need to be done</strong></h4><h6 id="bela-bootloader"> <a href="#bela-bootloader" class="anchor-heading" aria-labelledby="bela-bootloader"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Bela Bootloader</strong></h6><hr /><p>This still need to be converted… <a href="https://github.com/rcn-ee/repos/blob/master/bela-customizations/suite/bullseye/debian/bela_bootloader.sh#L99-L102">bela_bootloader.sh</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> echo "log: dd if=/mnt/boot/MLO of=${DEVICE} seek=${dd_spl_uboot_seek} bs=${dd_spl_uboot_bs}"
 dd if=/mnt/boot/MLO of=${DEVICE} seek=${dd_spl_uboot_seek} bs=${dd_spl_uboot_bs}
 echo "log: dd if=/mnt/boot/u-boot.img of=${DEVICE} seek=${dd_uboot_seek} bs=${dd_uboot_bs}"
 dd if=/mnt/boot/u-boot.img of=${DEVICE} seek=${dd_uboot_seek} bs=${dd_uboot_bs}
</code></pre></div></div><p>This should just call and depend on debian package bb-u-boot-am335x-evm</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /opt/u-boot/bb-u-boot-am335x-evm/install-mmcblk1.sh
</code></pre></div></div><h6 id="dhcp--etcdhcpdhcpdconf"> <a href="#dhcp--etcdhcpdhcpdconf" class="anchor-heading" aria-labelledby="dhcp--etcdhcpdhcpdconf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>DHCP /etc/dhcp/dhcpd.conf</strong></h6><hr /><p>Bela using dhcp to set usb0/usb1… <a href="https://github.com/rcn-ee/repos/blob/master/bela-customizations/suite/bullseye/debian/dhcpd.conf#L40-L46">https://github.com/rcn-ee/repos/blob/master/bela-customizations/suite/bullseye/debian/dhcpd.conf#L40-L46</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    subnet 192.168.7.0 netmask 255.255.255.0 {
        range 192.168.7.1;
    }

    subnet 192.168.6.0 netmask 255.255.255.0 {
</code></pre></div></div><p>In Bullsye, the exact same setup is done through systemd-network.. with: bb-usb-gadget package <a href="https://github.com/rcn-ee/repos/blob/master/bb-usb-gadgets/suite/bullseye/debian/usb0-DHCP.network">https://github.com/rcn-ee/repos/blob/master/bb-usb-gadgets/suite/bullseye/debian/usb0-DHCP.network</a></p><h6 id="bela-gadget"> <a href="#bela-gadget" class="anchor-heading" aria-labelledby="bela-gadget"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Bela Gadget</strong></h6><hr /><p>This should be tweaked <a href="https://github.com/BelaPlatform/bela-image-builder/blob/master/misc/rootfs/opt/Bela/bela_gadget.sh">https://github.com/BelaPlatform/bela-image-builder/blob/master/misc/rootfs/opt/Bela/bela_gadget.sh</a> in an option in: <a href="https://github.com/rcn-ee/repos/blob/master/bb-usb-gadgets/suite/bullseye/debian/bb-start-acm-ncm-rndis-old-gadget">https://github.com/rcn-ee/repos/blob/master/bb-usb-gadgets/suite/bullseye/debian/bb-start-acm-ncm-rndis-old-gadget</a> as it auto loads the gadget driver.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Unit]
Description=BeagleBoard.org USB gadgets
After=usb-gadget.target
ConditionFileIsExecutable=/usr/bin/bb-start-usb-gadgets
</code></pre></div></div><h3 id="writings"> <a href="#writings" class="anchor-heading" aria-labelledby="writings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Writings</strong></h3><p>I maintained weekly log my progress throughout the program. For the most part it has my work progress for the week and for the issue documented.</p><p><a href="https://krvprashanth.in/gsoc2022/docs/weeklyprogress/"><strong>Weekly Progress</strong></a></p><p><a href="https://krvprashanth.in/gsoc2022/docs/documentation/how-to-guides/"><strong>How-To Guides</strong></a></p><p><a href="https://krvprashanth.in/gsoc2022/docs/documentation/project-notes/"><strong>Project Notes</strong></a></p><p><a href="https://git.beagleboard.org/gsoc/building-bela-images/-/wikis/Weekly-meeting-minutes-of-meet!"><strong>Weekly Meeting Minutes</strong></a></p><hr /><h2 id="contributions-"> <a href="#contributions-" class="anchor-heading" aria-labelledby="contributions-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Contributions</strong> <a name="contribution"></a></h2><h3 id="achieved-milestones-"> <a href="#achieved-milestones-" class="anchor-heading" aria-labelledby="achieved-milestones-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Achieved Milestones</strong> <a name="milestones"></a></h3><ul><li>Debian package updated/packaged Bela dependencies<li>Packages are up in https://rcn-ee.com apt package manager and https://github.com/rcn-ee/repos<li>Built Bela Image with Beaglebone image-builder scripts<li>From now the Bela Image will be updated more often with BeagleBone Images<h3 id="git-repositories-"> <a href="#git-repositories-" class="anchor-heading" aria-labelledby="git-repositories-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Git Repositories</strong> <a name="repos"></a></h3></ul><p>Common software that is on or used for building bela image.</p><ul><li><a href="https://github.com/rcn-ee/repos">rcn-ee/repos</a> - Debian package configuration<li><a href="https://github.com/RobertCNelson/omap-image-builder">RobertCNelson/omap-image-builder</a> - Image builder<li><a href="https://github.com/RobertCNelson/ti-linux-kernel-dev">RobertCNelson/ti-linux-kernel-dev</a> - ti-linux-xenomai-bela-4.14.y<li><a href="https://git.beagleboard.org/krvprashanth/bela-customizations">Kurva Prashanth/bela-customizations</a> - Source for bela-customizations debian package</ul><h3 id="pull-requests-"> <a href="#pull-requests-" class="anchor-heading" aria-labelledby="pull-requests-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Pull Requests</strong> <a name="pr"></a></h3><p>In the following table, I present the pull requests (PRs) I created during the GSoC program.</p><h5 id="rcn-eerepos"> <a href="#rcn-eerepos" class="anchor-heading" aria-labelledby="rcn-eerepos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://github.com/rcn-ee/repos">rcn-ee/repos</a></h5><div class="table-wrapper"><table><thead><tr><th>PR<th>Status<tbody><tr><td>Add seasocks, xenomai debian packages configuration <a href="https://github.com/rcn-ee/repos/pull/60">[PR #60]</a><td>Closed<tr><td>Add debian package configuration of bela customizations <a href="https://github.com/rcn-ee/repos/pull/61">[PR #61]</a><td>Merged<tr><td>Add debian package configuration of hvcc <a href="https://github.com/rcn-ee/repos/pull/62">[PR #62]</a><td>Merged<tr><td>Add xenomai (stable/v3.0.x) debian packages configuration <a href="https://github.com/rcn-ee/repos/pull/63">[PR #63]</a><td>Closed<tr><td>bela-customizations: cleanup and add bb-start-acm-ncm-rndis-old-gadget <a href="https://github.com/rcn-ee/repos/pull/64">[PR #64]</a><td>Merged</table></div><h5 id="robertcnelsonomap-image-builder"> <a href="#robertcnelsonomap-image-builder" class="anchor-heading" aria-labelledby="robertcnelsonomap-image-builder"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://github.com/RobertCNelson/omap-image-builder">RobertCNelson/omap-image-builder</a></h5><div class="table-wrapper"><table><thead><tr><th>PR<th>Status<tbody><tr><td>Update packages list of Bela in configs <a href="https://github.com/RobertCNelson/omap-image-builder/pull/199">[PR #199]</a><td>Closed<tr><td>bela-bullseye-image-build <a href="https://github.com/RobertCNelson/omap-image-builder/pull/200">[PR #200]</a><td>Merged<tr><td>figured out what packages failed to install and made necessary changes <a href="https://github.com/RobertCNelson/omap-image-builder/pull/201">[PR #201]</a><td>Merged<tr><td>modify bela-bullseye chroot script <a href="https://github.com/RobertCNelson/omap-image-builder/pull/202">[PR #202]</a><td>Merged<tr><td>update to python3 version of hvcc compiler <a href="https://github.com/RobertCNelson/omap-image-builder/pull/205">[PR #205]</a><td>Merged<tr><td>bela boot <a href="https://github.com/RobertCNelson/omap-image-builder/pull/208">[#208]</a><td>Merged<tr><td>some more bela specific changes <a href="https://github.com/RobertCNelson/omap-image-builder/pull/209">[#209]</a><td>Merged</table></div><h5 id="robertcnelsonti-linux-kernel-dev"> <a href="#robertcnelsonti-linux-kernel-dev" class="anchor-heading" aria-labelledby="robertcnelsonti-linux-kernel-dev"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://github.com/RobertCNelson/ti-linux-kernel-dev">RobertCNelson/ti-linux-kernel-dev</a></h5><div class="table-wrapper"><table><thead><tr><th>PR<th>Status<tbody><tr><td>source to build the ti-linux-xenomai-4.14.y kernel debian package with bela configured config <a href="https://github.com/RobertCNelson/ti-linux-kernel-dev/pull/53">[PR #53]</a><td>Merged</table></div><hr /><h2 id="further-implementation"> <a href="#further-implementation" class="anchor-heading" aria-labelledby="further-implementation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Further Implementation</strong></h2><ul><li>Evaluate and Optimise boot times<li>Debian Package remaining Bela Core<ul><li>rtdm_pruss_irq<li>Bela IDE<li>prudebug</ul><li>Improvise bela-customizations package.</ul><hr /><h2 id="conclusion"> <a href="#conclusion" class="anchor-heading" aria-labelledby="conclusion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Conclusion</strong></h2><p>TODO</p><hr /><h2 id="helpful-links"> <a href="#helpful-links" class="anchor-heading" aria-labelledby="helpful-links"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Helpful Links</strong></h2><ul><li><a href="https://elinux.org/BeagleBoard/GSoC/Ideas-2022">Original GSoC Project idea</a><li><a href="https://github.com/BelaPlatform">https://github.com/BelaPlatform</a><li><a href="https://bela.io">https://bela.io</a><li><a href="https://github.com/beagleboard/image-builder">https://github.com/beagleboard/image-builder</a><li><a href="https://github.com/BelaPlatform/bela-image-builder">https://github.com/BelaPlatform/bela-image-builder</a></ul><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p></main><footer id="footer"><div style="text-align: center">All content licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> license unless otherwise stated.</div><br /> <i><div style="text-align: center">Copyright © </i> 2022 Kurva Prashanth.</div></footer><div class="d-flex mt-2"></div></footer></div></div><div class="search-overlay"></div></div>
